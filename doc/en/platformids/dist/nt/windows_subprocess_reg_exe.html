

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>5.45. dist.nt.windows_subprocess_reg_exe &mdash; platformids  documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="5.46. jy.dist.nt.Advapi32GetCurrentVersion(.java)" href="../../jy/dist/nt/Advapi32GetCurrentVersion.html" />
    <link rel="prev" title="5.44. dist.nt.windows_products" href="windows_products.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.1.36
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Shortcuts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">PlatformIDs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index_part_cockpit.html">apidoc</a></li>
</ul>
<p class="caption"><span class="caption-text">Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index_part_abstract.html">1. Abstract</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index_part_platform_support.html">2. Platform Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index_part_blueprint.html">3. Blueprint</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rtplatformids_cli.html">1. Command Line Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../os_categorization.html">2. OS Categorization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../distributions.html">3. Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index_part_documents.html">4. Documents</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index_modules.html">5. Modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../platformids.html">5.1. platformids.__init__</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../platformids.platforms.html">5.2. platformids.platforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../alpinelinux.html">5.3. platformids.dist.alpinelinux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../archlinux.html">5.4. platformids.dist.archlinux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../centos.html">5.5. platformids.dist.centos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cygwin.html">5.6. platformids.dist.cygwin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../darwin.html">5.7. platformids.dist.darwin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../debian.html">5.8. platformids.dist.debian</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fedora.html">5.9. platformids.dist.fedora</a></li>
<li class="toctree-l2"><a class="reference internal" href="../freebsd.html">5.10. platformids.dist.freebsd</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gentoo.html">5.11. platformids.dist.gentoo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hpux.html">5.12. platformids.dist.hpux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../netbsd.html">5.13. platformids.dist.netbsd</a></li>
<li class="toctree-l2"><a class="reference internal" href="../openbsd.html">5.14. platformids.dist.openbsd</a></li>
<li class="toctree-l2"><a class="reference internal" href="../opensuse.html">5.15. platformids.dist.opensuse</a></li>
<li class="toctree-l2"><a class="reference internal" href="../oraclelinux.html">5.16. platformids.dist.oraclelinux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../posix.html">5.17. platformids.dist.posix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rhel.html">5.18. platformids.dist.rhel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sles.html">5.19. platformids.dist.sles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../solaris.html">5.20. platformids.dist.solaris</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ubuntu.html">5.21. platformids.dist.ubuntu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../windows.html">5.22. platformids.dist.windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../net/kali.html">5.23. platformids.net.kali</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../net/openwrt.html">5.24. platformids.net.openwrt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../net/pfsense.html">5.25. platformids.net.pfsense</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../custom/aix.html">5.26. pythonids.dist.aix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../custom/blackarch.html">5.27. pythonids.dist.blackarch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../custom/dragonbsd.html">5.28. platformids.custom.dragonbsd</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../custom/ghostbsd.html">5.29. platformids.custom.ghostbsd</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../custom/linuxmint.html">5.30. platformids.custom.linuxmint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../custom/minix.html">5.31. platformids.custom.minix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../custom/minix2.html">5.32. platformids.custom.minix2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../custom/nomadbsd.html">5.33. platformids.custom.nomadbsd</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../custom/parrot.html">5.34. platformids.custom.parrot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../custom/pentoo.html">5.35. platformids.custom.pentoo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../custom/reactos.html">5.36. platformids.custom.reactos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../custom/slackware.html">5.37. platformids.custom.slackware</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../custom/trueos.html">5.38. platformids.custom.trueos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../embed/armbian.html">5.39. platformids.embed.armbian</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../embed/circuitpython.html">5.40. platformids.embed.circuitpython</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../embed/micropython.html">5.41. platformids.embed.micropython</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../embed/raspbian.html">5.42. platformids.embed.raspbian</a></li>
<li class="toctree-l2"><a class="reference internal" href="windows_kernel32_dll.html">5.43. windows_kernel32_dll</a></li>
<li class="toctree-l2"><a class="reference internal" href="windows_products.html">5.44. windows_products</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">5.45. windows_subprocess_reg_exe</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-platformids.dist.nt.windows_subprocess_reg_exe">5.45.1. Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#registrybyexe">5.45.1.1. RegistryByExe</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#init">5.45.1.1.1. __init__</a></li>
<li class="toctree-l5"><a class="reference internal" href="#read-currentversion">5.45.1.1.2. read_CurrentVersion</a></li>
<li class="toctree-l5"><a class="reference internal" href="#get-win32-osproductinf">5.45.1.1.3. get_win32_OSProductInf</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#exceptions">5.45.1.2. Exceptions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#source">5.45.2. Source</a></li>
<li class="toctree-l3"><a class="reference internal" href="#download">5.45.3. Download</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../jy/dist/nt/Advapi32GetCurrentVersion.html">5.46. Advapi32GetCurrentVersion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../jy/dist/nt/Kernel32GetProductInfo.html">5.47. Kernel32GetProductInfo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../jy/dist/nt/ReadCurrentVersionWinPrefs.html">5.48. ReadCurrentVersionWinPrefs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../index_part_indices.html">6. Indices and tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index_part_resources.html">7. Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">8. Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">9. External References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index_part_license.html">10. Licenses</a></li>
</ul>
<p class="caption"><span class="caption-text">Application</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../howto/index.html">Howto</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/index.html">FAQ</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">platformids</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index_modules.html">5. Modules</a> &raquo;</li>
        
      <li>5.45. dist.nt.windows_subprocess_reg_exe</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/dist/nt/windows_subprocess_reg_exe.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="dist-nt-windows-subprocess-reg-exe">
<span id="distntcallregexe"></span><h1>5.45. dist.nt.windows_subprocess_reg_exe<a class="headerlink" href="#dist-nt-windows-subprocess-reg-exe" title="Permalink to this headline">¶</a></h1>
<p>Module for the registry access by calling standard Windows registry editor <em>reg.exe</em>.</p>
<div class="section" id="module-platformids.dist.nt.windows_subprocess_reg_exe">
<span id="module"></span><h2>5.45.1. Module<a class="headerlink" href="#module-platformids.dist.nt.windows_subprocess_reg_exe" title="Permalink to this headline">¶</a></h2>
<p>Reads the MS-Windows registry by calling a subprocess for reg.exe.</p>
<p>This is a fallback solution when neither <em>winreg</em> / <em>_winreg</em>, nor in case
of Jython the Java APIs such as <em>WindowsPref</em>, <em>JNA</em>, or <em>JNI</em> are not
available.
This works also on <em>Cygwin</em>, when e.g. the path for <em>kernel32.dll</em> does not
match for the <em>ctypes</em>.</p>
<p>Avoid using it due to serious performance impact compared to
the others - but do when nothing else helps and the
version information matters.</p>
<div class="section" id="registrybyexe">
<h3>5.45.1.1. RegistryByExe<a class="headerlink" href="#registrybyexe" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="platformids.dist.nt.windows_subprocess_reg_exe.RegistryByExe">
<em class="property">class </em><code class="sig-prename descclassname">platformids.dist.nt.windows_subprocess_reg_exe.</code><code class="sig-name descname">RegistryByExe</code><a class="reference internal" href="../../_modules/platformids/dist/nt/windows_subprocess_reg_exe.html#RegistryByExe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#platformids.dist.nt.windows_subprocess_reg_exe.RegistryByExe" title="Permalink to this definition">¶</a></dt>
<dd><p>Registry read access by <em>reg.exe</em> to</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion&quot;</span>
</pre></div>
</div>
</dd></dl>

<div class="section" id="init">
<h4>5.45.1.1.1. __init__<a class="headerlink" href="#init" title="Permalink to this headline">¶</a></h4>
<dl class="method">
<dt id="platformids.dist.nt.windows_subprocess_reg_exe.RegistryByExe.__init__">
<code class="sig-prename descclassname">RegistryByExe.</code><code class="sig-name descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/platformids/dist/nt/windows_subprocess_reg_exe.html#RegistryByExe.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#platformids.dist.nt.windows_subprocess_reg_exe.RegistryByExe.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

</div>
<div class="section" id="read-currentversion">
<h4>5.45.1.1.2. read_CurrentVersion<a class="headerlink" href="#read-currentversion" title="Permalink to this headline">¶</a></h4>
<dl class="method">
<dt id="platformids.dist.nt.windows_subprocess_reg_exe.RegistryByExe.read_CurrentVersion">
<code class="sig-prename descclassname">RegistryByExe.</code><code class="sig-name descname">read_CurrentVersion</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/platformids/dist/nt/windows_subprocess_reg_exe.html#RegistryByExe.read_CurrentVersion"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#platformids.dist.nt.windows_subprocess_reg_exe.RegistryByExe.read_CurrentVersion" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the constant - thus hardcoded - key from</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;HKLM\Software\Microsoft\Windows NT\CurrentVersion&quot;</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>None</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The dictionary of the <em>CurrentVersion</em>.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference internal" href="#platformids.dist.nt.windows_subprocess_reg_exe.PlatformIDsReadRegExeError" title="platformids.dist.nt.windows_subprocess_reg_exe.PlatformIDsReadRegExeError"><strong>PlatformIDsReadRegExeError</strong></a> – </p></li>
<li><p><strong>pass-through</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="get-win32-osproductinf">
<h4>5.45.1.1.3. get_win32_OSProductInf<a class="headerlink" href="#get-win32-osproductinf" title="Permalink to this headline">¶</a></h4>
<dl class="method">
<dt id="platformids.dist.nt.windows_subprocess_reg_exe.RegistryByExe.get_win32_OSProductInfo">
<code class="sig-prename descclassname">RegistryByExe.</code><code class="sig-name descname">get_win32_OSProductInfo</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/platformids/dist/nt/windows_subprocess_reg_exe.html#RegistryByExe.get_win32_OSProductInfo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#platformids.dist.nt.windows_subprocess_reg_exe.RegistryByExe.get_win32_OSProductInfo" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimates the product type, because this is a fallback
when nothing else is available.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>None</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>The estimated product type as a reduction of the
original</p>
<blockquote>
<div><p>”pdwReturnedProductType”</p>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>pass-through</strong> – </p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="exceptions">
<h3>5.45.1.2. Exceptions<a class="headerlink" href="#exceptions" title="Permalink to this headline">¶</a></h3>
<dl class="exception">
<dt id="platformids.dist.nt.windows_subprocess_reg_exe.PlatformIDsReadRegExeError">
<em class="property">exception </em><code class="sig-prename descclassname">platformids.dist.nt.windows_subprocess_reg_exe.</code><code class="sig-name descname">PlatformIDsReadRegExeError</code><a class="reference internal" href="../../_modules/platformids/dist/nt/windows_subprocess_reg_exe.html#PlatformIDsReadRegExeError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#platformids.dist.nt.windows_subprocess_reg_exe.PlatformIDsReadRegExeError" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</div>
<div class="section" id="source">
<h2>5.45.2. Source<a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;Reads the MS-Windows registry by calling a subprocess for reg.exe.</span>

<span class="sd">This is a fallback solution when neither *winreg* / *_winreg*, nor in case </span>
<span class="sd">of Jython the Java APIs such as *WindowsPref*, *JNA*, or *JNI* are not</span>
<span class="sd">available.</span>
<span class="sd">This works also on *Cygwin*, when e.g. the path for *kernel32.dll* does not</span>
<span class="sd">match for the *ctypes*.</span>

<span class="sd">Avoid using it due to serious performance impact compared to </span>
<span class="sd">the others - but do when nothing else helps and the </span>
<span class="sd">version information matters. </span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span>

<span class="kn">import</span> <span class="nn">re</span>

<span class="kn">from</span> <span class="nn">subprocess</span> <span class="kn">import</span> <span class="n">Popen</span><span class="p">,</span> <span class="n">PIPE</span>

<span class="kn">from</span> <span class="nn">platformids</span> <span class="kn">import</span> <span class="n">PlatformIDsError</span>
<span class="kn">from</span> <span class="nn">platformids.dist.windows</span> <span class="kn">import</span> <span class="n">VER_NT_SERVER</span><span class="p">,</span> <span class="n">VER_NT_WORKSTATION</span><span class="p">,</span> \
    <span class="n">VER_NT_DOMAIN_CONTROLLER</span><span class="p">,</span> <span class="n">VER_NT_IOT</span><span class="p">,</span> <span class="n">VER_NT_GENERIC</span>


<span class="n">__author__</span> <span class="o">=</span> <span class="s1">&#39;Arno-Can Uestuensoez&#39;</span>
<span class="n">__license__</span> <span class="o">=</span> <span class="s2">&quot;Artistic-License-2.0 + Forced-Fairplay-Constraints&quot;</span>
<span class="n">__copyright__</span> <span class="o">=</span> <span class="s2">&quot;Copyright (C) 2010-2018 Arno-Can Uestuensoez&quot;</span> \
                <span class="s2">&quot; @Ingenieurbuero Arno-Can Uestuensoez&quot;</span>
<span class="n">__version__</span> <span class="o">=</span> <span class="s1">&#39;0.1.2&#39;</span>
<span class="n">__uuid__</span> <span class="o">=</span> <span class="s2">&quot;7add5ded-c39b-4b6e-8c87-1b3a1c150ee9&quot;</span>

<span class="n">__docformat__</span> <span class="o">=</span> <span class="s2">&quot;restructuredtext en&quot;</span>


<span class="k">class</span> <span class="nc">PlatformIDsReadRegExeError</span><span class="p">(</span><span class="n">PlatformIDsError</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="k">class</span> <span class="nc">RegistryByExe</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Registry read access by *reg.exe* to ::</span>

<span class="sd">       &quot;HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion&quot;</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="c1">#: used as cache for following calls</span>
        <span class="c1">#: the cache represents this platform, so may not be altered</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        
        <span class="c1"># cached product type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">product_type</span> <span class="o">=</span> <span class="bp">None</span>


    <span class="k">def</span> <span class="nf">read_CurrentVersion</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reads the constant - thus hardcoded - key from :: </span>

<span class="sd">             &quot;HKLM\Software\Microsoft\Windows NT\CurrentVersion&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            None</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            The dictionary of the *CurrentVersion*.</span>
<span class="sd">        </span>
<span class="sd">        Raises:</span>
<span class="sd">            PlatformIDsReadRegExeError</span>
<span class="sd">            </span>
<span class="sd">            pass-through</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="s1">&#39;c:\Windows</span><span class="se">\\</span><span class="s1">system32</span><span class="se">\\</span><span class="s1">reg.exe query &#39;</span>
        <span class="n">cmd</span> <span class="o">+=</span> <span class="s1">&#39;&quot;HKLM\Software\Microsoft\Windows NT\CurrentVersion&quot;&#39;</span>

        <span class="n">p</span> <span class="o">=</span> <span class="n">Popen</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">PIPE</span><span class="p">)</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">PlatformIDsReadRegExeError</span><span class="p">(</span><span class="s2">&quot;read registry failed: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">out</span><span class="p">))</span>
        
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;^ *([^ ]+) *REG_[^ ]* *(.*)[</span><span class="se">\r</span><span class="s1">][</span><span class="se">\n</span><span class="s1">]*$&#39;</span><span class="p">,</span>  <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">MULTILINE</span><span class="p">):</span>  <span class="c1"># @UndefinedVariable</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span>


    <span class="k">def</span> <span class="nf">get_win32_OSProductInfo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>   
        <span class="sd">&quot;&quot;&quot;Estimates the product type, because this is a fallback</span>
<span class="sd">        when nothing else is available.</span>
<span class="sd">         </span>
<span class="sd">        Args:</span>
<span class="sd">            None</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            The estimated product type as a reduction of the</span>
<span class="sd">            original </span>
<span class="sd">            </span>
<span class="sd">                &quot;pdwReturnedProductType&quot;</span>
<span class="sd">        </span>
<span class="sd">        Raises:</span>
<span class="sd">            pass-through</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="p">:</span>
            <span class="c1"># set cache</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">read_CurrentVersion</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">product_type</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c1"># use cached product type</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">product_type</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="c1">#</span>
            <span class="c1"># for NT &gt;= 6.0</span>
            <span class="c1">#</span>
            <span class="n">eid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resultp</span><span class="p">[</span><span class="s1">&#39;EditionID&#39;</span><span class="p">]</span>  
            <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;.*[Ss]erver&#39;</span><span class="p">,</span> <span class="n">eid</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">product_type</span> <span class="o">=</span> <span class="n">VER_NT_SERVER</span>  <span class="c1"># 0x0000003 #: see wProductType </span>
                <span class="k">return</span> <span class="n">VER_NT_SERVER</span>
                
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">resultp</span><span class="p">[</span><span class="s1">&#39;InstallationType&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Client&#39;</span><span class="p">:</span>  <span class="c1"># has to be present when *EditionID* is</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">product_type</span> <span class="o">=</span> <span class="n">VER_NT_WORKSTATION</span>  <span class="c1"># 0x0000001 #: see wProductType </span>
                <span class="k">return</span> <span class="n">VER_NT_WORKSTATION</span>

            <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;.*[Dd]omain&#39;</span><span class="p">,</span> <span class="n">eid</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">product_type</span> <span class="o">=</span> <span class="n">VER_NT_DOMAIN_CONTROLLER</span>  <span class="c1"># 0x0000002 #: see wProductType </span>
                <span class="k">return</span> <span class="n">VER_NT_DOMAIN_CONTROLLER</span>


            <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;.*[Ii][Oo][Tt]&#39;</span><span class="p">,</span> <span class="n">eid</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">product_type</span> <span class="o">=</span> <span class="n">VER_NT_IOT</span>  <span class="c1"># 0x0000004 #: non standard enum </span>
                <span class="k">return</span> <span class="n">VER_NT_IOT</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">product_type</span> <span class="o">=</span> <span class="n">VER_NT_GENERIC</span>  <span class="c1"># 0x0000000 #: non standard enum </span>
                <span class="k">return</span> <span class="n">VER_NT_GENERIC</span>

        <span class="k">except</span><span class="p">:</span>
            <span class="c1">#</span>
            <span class="c1"># for NT &lt; 6.0</span>
            <span class="c1">#</span>
            <span class="c1"># do not want spend much effort for legacy has past EOL, so...</span>
            <span class="c1">#</span>
            
            <span class="n">pnam</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resultp</span><span class="p">[</span><span class="s1">&#39;ProductName&#39;</span><span class="p">]</span>  
            <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;.*XP&#39;</span><span class="p">,</span> <span class="n">pnam</span><span class="p">):</span>
                <span class="c1"># WindowsXP</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">product_type</span> <span class="o">=</span> <span class="n">VER_NT_WORKSTATION</span>  <span class="c1"># 0x0000001 #: see wProductType </span>
                <span class="k">return</span> <span class="n">VER_NT_WORKSTATION</span>

            <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;.*SERVER&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">resultp</span><span class="p">[</span><span class="s1">&#39;SourcePath&#39;</span><span class="p">]):</span>  <span class="c1"># not reliable...</span>
                <span class="c1"># WindowsXP</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">product_type</span> <span class="o">=</span> <span class="n">VER_NT_SERVER</span>  <span class="c1"># 0x0000003 #: see wProductType </span>
                <span class="k">return</span> <span class="n">VER_NT_SERVER</span>
            
            <span class="k">else</span><span class="p">:</span>
                <span class="c1">#</span>
                <span class="c1"># may match a lot...</span>
                <span class="c1">#</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">product_type</span> <span class="o">=</span> <span class="n">VER_NT_GENERIC</span>  <span class="c1"># 0x0000000 #: non standard enum </span>
                <span class="k">return</span> <span class="n">VER_NT_GENERIC</span>
            
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="download">
<h2>5.45.3. Download<a class="headerlink" href="#download" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="../../_static/dist/nt/windows_subprocess_reg_exe.py">windows_subprocess_reg_exe.py</a></p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../jy/dist/nt/Advapi32GetCurrentVersion.html" class="btn btn-neutral float-right" title="5.46. jy.dist.nt.Advapi32GetCurrentVersion(.java)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="windows_products.html" class="btn btn-neutral float-left" title="5.44. dist.nt.windows_products" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Copyright (C) 2016 Arno-Can Uestuensoez @Ingenieurbuero Arno-Can Uestuensoez
      <span class="lastupdated">
        Last updated on Dec 18, 2019.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>